<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Using PHP in JavaScript | wp-playground</title><meta name="description" content="Documentation for wp-playground"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><link rel="stylesheet" href="../assets/custom.css"/><script async src="../assets/search.js" id="search-script"></script><link rel="stylesheet" href="../assets/pages.css"/></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base="..">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">wp-playground</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<ul class="tsd-breadcrumb">
<li><a href="../modules.html">wp-playground</a></li>
<li><span>Playground</span></li>
<li><a href="using-php-in-javascript.html">Using PHP in JavaScript</a></li></ul>
<h1> Using PHP in JavaScript</h1></div>
<div class="tsd-panel tsd-typography">
<a href="#compiling-php-to-webassembly-and-using-it-in-javascript" id="compiling-php-to-webassembly-and-using-it-in-javascript" style="color: inherit; text-decoration: none;">
  <h1>Compiling PHP to WebAssembly and using it in JavaScript</h1>
</a>
<p>The <a href="https://github.com/WordPress/wordpress-playground/blob/trunk/packages/php-wasm/web"><code>php-wasm-web</code></a> and <a href="https://github.com/WordPress/wordpress-playground/blob/trunk/packages/php-wasm/node"><code>php-wasm-node</code></a> modules bring PHP into JavaScript as a WebAssembly module:</p>
<pre><code class="language-js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">PHP</span><span class="hl-1">, </span><span class="hl-2">getPHPLoaderModule</span><span class="hl-1">, </span><span class="hl-2">loadPHPRuntime</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;@php-wasm/web&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">runtime</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPHPRuntime</span><span class="hl-1">(</span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">getPHPLoaderModule</span><span class="hl-1">(</span><span class="hl-2">phpVersion</span><span class="hl-1">));</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">php</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">PHP</span><span class="hl-1">(</span><span class="hl-2">runtime</span><span class="hl-1">);</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">php</span><span class="hl-1">.</span><span class="hl-6">run</span><span class="hl-1">(</span><span class="hl-3">`&lt;?php echo &quot;Hello from PHP!&quot;;`</span><span class="hl-1">).</span><span class="hl-2">stdout</span><span class="hl-1">);</span><br/><span class="hl-8">// Output: &quot;Hello from PHP!&quot;</span>
</code></pre>
<p>It consists of two major building blocks:</p>
<ul>
<li><a href="#php-to-webassembly-build-pipeline">PHP to WebAssembly build pipeline</a></li>
<li><a href="#javascript-bindings-for-the-webassembly-php">JavaScript bindings for the WebAssembly PHP</a></li>
</ul>
<p>See also the <a href="api/web.html">API Reference</a>.</p>

<a href="#php-to-webassembly-build-pipeline" id="php-to-webassembly-build-pipeline" style="color: inherit; text-decoration: none;">
  <h2>PHP to WebAssembly build pipeline</h2>
</a>
<p>The pipeline lives in a <a href="https://github.com/WordPress/wordpress-playground/blob/trunk/src/packages/php-wasm/compile/Dockerfile"><code>Dockerfile</code></a>. It was originally forked from <a href="https://github.com/seanmorris/php-wasm">seanmorris/php-wasm</a></p>
<p>In broad strokes, that <code>Dockerfile</code>:</p>
<ul>
<li>Installs all the necessary linux packages (like <code>build-essential</code>)</li>
<li>Downloads PHP and the required libraries, e.g. <code>sqlite3</code>.</li>
<li>Applies a few patches.</li>
<li>Compiles everything using <a href="https://emscripten.org/">Emscripten</a>, a drop-in replacement for the C compiler.</li>
<li>Compiles <code>php_wasm.c</code> – a convenient API for JavaScript.</li>
<li>Outputs a <code>php.wasm</code> file and one or more JavaScript loaders, depending on the configuration.</li>
<li>Transforms the Emscripten&#39;s default <code>php.js</code> output into an ESM module with additional features.</li>
</ul>
<p>To find out more about each step, refer directly to the <a href="https://github.com/WordPress/wordpress-playground/blob/trunk/src/packages/php-wasm/compile/Dockerfile">Dockerfile</a>.</p>

<a href="#building" id="building" style="color: inherit; text-decoration: none;">
  <h3>Building</h3>
</a>
<p>To build all PHP versions, run <code>nx recompile-php:all php-wasm-web</code> (or php-wasm-node) in the repository root. You&#39;ll find the output files in <code>packages/php-wasm/php-web/public</code>. To build a specific version, run <code>nx recompile-php:all php-wasm-node --PHP_VERSION=8.0</code>.</p>

<a href="#php-extensions" id="php-extensions" style="color: inherit; text-decoration: none;">
  <h3>PHP extensions</h3>
</a>
<p>PHP is built with several extensions listed in the <a href="https://github.com/WordPress/wordpress-playground/blob/trunk/src/packages/php-wasm/compile/Dockerfile"><code>Dockerfile</code></a>.</p>
<p>Some extensions, like <code>zip</code>, can be turned on or off during the build. Others, like <code>sqlite3</code>, are hardcoded.</p>
<p>If you need to turn off one of the hardcoded extensions, feel free to open an issue in this repo. Better yet, this project needs contributors. You are more than welcome to open a PR and author the change you need.</p>

<a href="#c-api-exposed-to-javascript" id="c-api-exposed-to-javascript" style="color: inherit; text-decoration: none;">
  <h3>C API exposed to JavaScript</h3>
</a>
<p>The C API exposed to JavaScript lives in the <a href="https://github.com/WordPress/wordpress-playground/blob/trunk/src/packages/php-wasm/compile/build-assets/php_wasm.c"><code>php_wasm.c</code></a> file. The most important functions are:</p>
<ul>
<li><code>void phpwasm_init()</code> – It creates a new PHP context and must be called before running any PHP code.</li>
<li><code>int phpwasm_run(char *code)</code> – Runs a PHP script and writes the output to /tmp/stdout and /tmp/stderr. Returns the exit code.</li>
<li><code>void phpwasm_refresh()</code> – Destroy the current PHP context and starts a new one. Call it after running one PHP script and before running another.</li>
</ul>
<p>Refer to the inline documentation in <a href="https://github.com/WordPress/wordpress-playground/blob/trunk/src/packages/php-wasm/compile/build-assets/php_wasm.c"><code>php_wasm.c</code></a> to learn more.</p>

<a href="#build-configuration" id="build-configuration" style="color: inherit; text-decoration: none;">
  <h3>Build configuration</h3>
</a>
<p>The build is configurable via the <a href="https://docs.docker.com/engine/reference/commandline/build/#set-build-time-variables---build-arg">Docker <code>--build-arg</code> feature</a>. You can set them up through the <code>build.js</code> script, just run this command to get the usage message:</p>
<pre><code class="language-sh"><span class="hl-1">nx </span><span class="hl-3">recompile-php</span><span class="hl-1"> </span><span class="hl-3">php-wasm-web</span>
</code></pre>
<p><strong>Supported build options:</strong></p>
<ul>
<li><code>PHP_VERSION</code> – The PHP version to build, default: <code>8.0.24</code>. This value must point to an existing branch of the <a href="https://github.com/php/php-src.git">https://github.com/php/php-src.git</a> repository when prefixed with <code>PHP-</code>. For example, <code>7.4.0</code> is valid because the branch <code>PHP-7.4.0</code> exists, but just <code>7</code> is invalid because there&#39;s no branch <code>PHP-7</code>. The PHP versions that are known to work are <code>7.4.*</code> and <code>8.0.*</code>. Others likely work as well but they haven&#39;t been tried.</li>
<li><code>EMSCRIPTEN_ENVIRONMENT</code> – <code>web</code> or <code>node</code>, default: <code>web</code>. The platform to build for. When building for <code>web</code>, two JavaScript loaders will be created: <code>php-web.js</code> and <code>php-webworker.js</code>. When building for Node.js, only one loader called <code>php-node.js</code> will be created.</li>
<li><code>WITH_LIBXML</code> – <code>yes</code> or <code>no</code>, default: <code>no</code>. Whether to build with <code>libxml2</code> and the <code>dom</code>, <code>xml</code>, and <code>simplexml</code> PHP extensions (<code>DOMDocument</code>, <code>SimpleXML</code>, ..).</li>
<li><code>WITH_LIBZIP</code> – <code>yes</code> or <code>no</code>, default: <code>yes</code>. Whether to build with <code>zlib</code>, <code>libzip</code>, and the <code>zip</code> PHP extension (<code>ZipArchive</code>).</li>
<li><code>WITH_VRZNO</code> – <code>yes</code> or <code>no</code>, default: <code>yes</code> when PHP_VERSION is 7.*. Whether to build with <a href="https://github.com/seanmorris/vrzno/fork">the <code>vrzno</code> PHP extension</a> that enables running JavaScript code from PHP.</li>
<li><code>WITH_NODEFS</code> – <code>yes</code> or <code>no</code>, default: <code>no</code>. Whether to include <a href="https://emscripten.org/docs/api_reference/Filesystem-API.html#filesystem-api-nodefs">the Emscripten&#39;s NODEFS JavaScript library</a>. It&#39;s useful for loading files and mounting directories from the local filesystem when running php.wasm from Node.js.</li>
</ul>

<a href="#javascript-module" id="javascript-module" style="color: inherit; text-decoration: none;">
  <h3>JavaScript module</h3>
</a>
<p>The <code>php.js</code> file generated by this build process is <strong>not</strong> a vanilla Emscripten module. Instead, it&#39;s an ESM module that wraps the regular Emscripten output and adds some extra functionality.</p>
<p>Here&#39;s the API it exposes:</p>
<pre><code class="language-js"><span class="hl-8">// php.wasm size in bytes:</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">dependenciesTotalSize</span><span class="hl-1"> = </span><span class="hl-9">5644199</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// php.wasm filename:</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">dependencyFilename</span><span class="hl-1"> = </span><span class="hl-3">&#39;php.wasm&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// Run Emscripten&#39;s generated module:</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-2">jsEnv</span><span class="hl-1">, </span><span class="hl-2">emscriptenModuleArgs</span><span class="hl-1">) {}</span>
</code></pre>

<a href="#javascript-bindings-for-the-webassembly-php" id="javascript-bindings-for-the-webassembly-php" style="color: inherit; text-decoration: none;">
  <h2>JavaScript bindings for the WebAssembly PHP</h2>
</a>
<p><code>php-wasm-web</code> provides a stack of APIs to interact with the WebAssembly module:</p>
<ul>
<li>A <code>PHP</code> class to directly interface with the WebAssembly module.</li>
<li>A <code>PHPServer</code> class to use PHP for handling HTTP requests.</li>
<li>A <code>PHPBrowser</code> class to handle cookies and redirects emitted by <code>PHPServer</code></li>
</ul>

<a href="#building-1" id="building-1" style="color: inherit; text-decoration: none;">
  <h3>Building</h3>
</a>
<p>To build the JavaScript API, just build the entire project with <code>yarn run build:all</code>.</p>

<a href="#api" id="api" style="color: inherit; text-decoration: none;">
  <h2>API</h2>
</a>
<p>Below you&#39;ll find a few especially relevant parts of the API. Consult the <a href="api/web.html">php-wasm-web API reference page</a> to learn about the rest of it.</p>

<a href="#loadphpruntime" id="loadphpruntime" style="color: inherit; text-decoration: none;">
  <h3>loadPHPRuntime</h3>
</a>
<!-- include /docs/api/modules/php_wasm_web.md#loadPHPRuntime -->

<p>▸ <strong>loadPHPRuntime</strong>(<code>phpLoaderModule</code>, <code>phpModuleArgs?</code>, <code>dataDependenciesModules?</code>): <a href="api/modules/php_wasm_web.html"><code>Promise</code></a>&lt;<code>number</code>&gt;</p>
<p>Loads the PHP runtime with the given arguments and data dependencies.</p>
<p>This function handles the entire PHP initialization pipeline. In particular, it:</p>
<ul>
<li>Instantiates the Emscripten PHP module</li>
<li>Wires it together with the data dependencies and loads them</li>
<li>Ensures is all happens in a correct order</li>
<li>Waits until the entire loading sequence is finished</li>
</ul>
<p>Basic usage:</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">phpLoaderModule</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">getPHPLoaderModule</span><span class="hl-1">(</span><span class="hl-3">&#39;7.4&#39;</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">php</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPHPRuntime</span><span class="hl-1">(</span><span class="hl-2">phpLoaderModule</span><span class="hl-1">);</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">php</span><span class="hl-1">.</span><span class="hl-6">run</span><span class="hl-1">(</span><span class="hl-3">`&lt;?php echo &quot;Hello, world!&quot;; `</span><span class="hl-1">));</span><br/><span class="hl-8">// { stdout: ArrayBuffer containing the string &quot;Hello, world!&quot;, stderr: [&#39;&#39;], exitCode: 0 }</span>
</code></pre>
<p><strong>The PHP loader module:</strong></p>
<p>In the basic usage example, <code>phpLoaderModule</code> is <strong>not</strong> a vanilla Emscripten module. Instead,
it&#39;s an ESM module that wraps the regular Emscripten output and adds some
extra functionality. It&#39;s generated by the Dockerfile shipped with this repo.
Here&#39;s the API it provides:</p>
<pre><code class="language-js"><span class="hl-8">// php.wasm size in bytes:</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">dependenciesTotalSize</span><span class="hl-1"> = </span><span class="hl-9">5644199</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// php.wasm filename:</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">dependencyFilename</span><span class="hl-1"> = </span><span class="hl-3">&#39;php.wasm&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// Run Emscripten&#39;s generated module:</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-2">jsEnv</span><span class="hl-1">, </span><span class="hl-2">emscriptenModuleArgs</span><span class="hl-1">) {}</span>
</code></pre>
<p><strong>PHP Filesystem:</strong></p>
<p>Once initialized, the PHP has its own filesystem separate from the project
files. It&#39;s provided by <a href="https://emscripten.org/docs/api_reference/Filesystem-API.html">Emscripten and uses its FS library</a>.</p>
<p>The API exposed to you via the PHP class is succinct and abstracts
await certain unintuitive parts of low-level FS interactions.</p>
<p>Here&#39;s how to use it:</p>
<pre><code class="language-js"><span class="hl-8">// Recursively create a /var/www directory</span><br/><span class="hl-2">php</span><span class="hl-1">.</span><span class="hl-6">mkdirTree</span><span class="hl-1">(</span><span class="hl-3">&#39;/var/www&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">php</span><span class="hl-1">.</span><span class="hl-6">fileExists</span><span class="hl-1">(</span><span class="hl-3">&#39;/var/www/file.txt&#39;</span><span class="hl-1">));</span><br/><span class="hl-8">// false</span><br/><br/><span class="hl-2">php</span><span class="hl-1">.</span><span class="hl-6">writeFile</span><span class="hl-1">(</span><span class="hl-3">&#39;/var/www/file.txt&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Hello from the filesystem!&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">php</span><span class="hl-1">.</span><span class="hl-6">fileExists</span><span class="hl-1">(</span><span class="hl-3">&#39;/var/www/file.txt&#39;</span><span class="hl-1">));</span><br/><span class="hl-8">// true</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">php</span><span class="hl-1">.</span><span class="hl-6">readFile</span><span class="hl-1">(</span><span class="hl-3">&#39;/var/www/file.txt&#39;</span><span class="hl-1">));</span><br/><span class="hl-8">// &quot;Hello from the filesystem!</span><br/><br/><span class="hl-8">// Delete the file:</span><br/><span class="hl-2">php</span><span class="hl-1">.</span><span class="hl-6">unlink</span><span class="hl-1">(</span><span class="hl-3">&#39;/var/www/file.txt&#39;</span><span class="hl-1">);</span>
</code></pre>
<p>For more details consult the PHP class directly.</p>
<p><strong>Data dependencies:</strong></p>
<p>Using existing PHP packages by manually recreating them file-by-file would
be quite inconvenient. Fortunately, Emscripten provides a &quot;data dependencies&quot;
feature.</p>
<p>Data dependencies consist of a <code>dependency.data</code> file and a <code>dependency.js</code> loader and
can be packaged with the <a href="api/modules/php_wasm_web.html">file_packager.py tool</a>.
This project requires wrapping the Emscripten-generated <code>dependency.js</code> file in an ES
module as follows:</p>
<ol>
<li>Prepend <code>export default function(emscriptenPHPModule) {&#39;; </code></li>
<li>Prepend <code>export const dependencyFilename = &#39;&lt;DATA FILE NAME&gt;&#39;; </code></li>
<li>Prepend <code>export const dependenciesTotalSize = &lt;DATA FILE SIZE&gt;;</code></li>
<li>Append <code>}</code></li>
</ol>
<p>Be sure to use the <code>--export-name=&quot;emscriptenPHPModule&quot;</code> file_packager.py option.</p>
<p>You want the final output to look as follows:</p>
<pre><code class="language-js"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">dependenciesTotalSize</span><span class="hl-1"> = </span><span class="hl-9">5644199</span><span class="hl-1">;</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">dependencyFilename</span><span class="hl-1"> = </span><span class="hl-3">&#39;dependency.data&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-0">default</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-2">emscriptenPHPModule</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-8">// Emscripten-generated code:</span><br/><span class="hl-1">    </span><span class="hl-4">var</span><span class="hl-1"> </span><span class="hl-2">Module</span><span class="hl-1"> =</span><br/><span class="hl-1">        </span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-2">emscriptenPHPModule</span><span class="hl-1"> !== </span><span class="hl-3">&#39;undefined&#39;</span><span class="hl-1"> ? </span><span class="hl-2">emscriptenPHPModule</span><span class="hl-1"> : {};</span><br/><span class="hl-1">    </span><span class="hl-8">// ... the rest of it ...</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Such a constructions enables loading the <code>dependency.js</code> as an ES Module using
<code>import(&quot;/dependency.js&quot;)</code>.</p>
<p>Once it&#39;s ready, you can load PHP and your data dependencies as follows:</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> [</span><span class="hl-5">phpLoaderModule</span><span class="hl-1">, </span><span class="hl-5">wordPressLoaderModule</span><span class="hl-1">] = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-7">Promise</span><span class="hl-1">.</span><span class="hl-6">all</span><span class="hl-1">([</span><br/><span class="hl-1">    </span><span class="hl-6">getPHPLoaderModule</span><span class="hl-1">(</span><span class="hl-3">&#39;7.4&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-4">import</span><span class="hl-1">(</span><span class="hl-3">&#39;/wp.js&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">]);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">php</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPHPRuntime</span><span class="hl-1">(</span><span class="hl-2">phpLoaderModule</span><span class="hl-1">, {}, [</span><span class="hl-2">wordPressLoaderModule</span><span class="hl-1">]);</span>
</code></pre>
<!-- /include /docs/api/modules/php_wasm_web.md#loadPHPRuntime -->


<a href="#php-serverjs" id="php-serverjs" style="color: inherit; text-decoration: none;">
  <h3>php-server.js</h3>
</a>
<!-- include /docs/api/classes/php_wasm_web.PHPServer.md#Class: PHPServer -->

<p><a href="api/classes/php_wasm_web.PHPServer.html">@php-wasm/web</a>.PHPServer</p>
<p>A fake PHP server that handles HTTP requests but does not
bind to any port.</p>
<p><strong><code>Example</code></strong></p>
<pre><code class="language-js"><span class="hl-0">import</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">loadPHPRuntime</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">PHP</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">PHPServer</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">PHPBrowser</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">getPHPLoaderModule</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;@php-wasm/web&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">runtime</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">loadPHPRuntime</span><span class="hl-1">(</span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">getPHPLoaderModule</span><span class="hl-1">(</span><span class="hl-3">&#39;7.4&#39;</span><span class="hl-1">));</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">php</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">PHP</span><span class="hl-1">(</span><span class="hl-2">runtime</span><span class="hl-1">);</span><br/><br/><span class="hl-2">php</span><span class="hl-1">.</span><span class="hl-6">mkdirTree</span><span class="hl-1">(</span><span class="hl-3">&#39;/www&#39;</span><span class="hl-1">);</span><br/><span class="hl-2">php</span><span class="hl-1">.</span><span class="hl-6">writeFile</span><span class="hl-1">(</span><span class="hl-3">&#39;/www/index.php&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;&lt;?php echo &quot;Hi from PHP!&quot;; &#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">server</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">PHPServer</span><span class="hl-1">(</span><span class="hl-2">php</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-8">// PHP FS path to serve the files from:</span><br/><span class="hl-1">    </span><span class="hl-2">documentRoot:</span><span class="hl-1"> </span><span class="hl-3">&#39;/www&#39;</span><span class="hl-1">,</span><br/><br/><span class="hl-1">    </span><span class="hl-8">// Used to populate $_SERVER[&#39;SERVER_NAME&#39;] etc.:</span><br/><span class="hl-1">    </span><span class="hl-2">absoluteUrl:</span><span class="hl-1"> </span><span class="hl-3">&#39;http://127.0.0.1&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">output</span><span class="hl-1"> = </span><span class="hl-2">server</span><span class="hl-1">.</span><span class="hl-6">request</span><span class="hl-1">({ </span><span class="hl-2">path:</span><span class="hl-1"> </span><span class="hl-3">&#39;/index.php&#39;</span><span class="hl-1"> }).</span><span class="hl-2">body</span><span class="hl-1">;</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">TextDecoder</span><span class="hl-1">().</span><span class="hl-6">decode</span><span class="hl-1">(</span><span class="hl-2">output</span><span class="hl-1">));</span><br/><span class="hl-8">// &quot;Hi from PHP!&quot;</span>
</code></pre>
<!-- /include /docs/api/classes/php_wasm_web.PHPServer.md#Class: PHPServer --></div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current"><a href="../modules.html">wp-<wbr/>playground</a>
<ul>
<li class="current pages-entry pages-entry-menu pages-entry-depth-1"><a>Playground</a>
<ul>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="index.html">Start here</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="embedding-wordpress-playground-on-other-websites.html">Embedding <wbr/>Word<wbr/>Press playground-<wbr/>on other websites</a></li>
<li class="current selected pages-entry pages-entry-page pages-entry-depth-2"><a href="using-php-in-javascript.html">Using PHP in <wbr/>Java<wbr/>Script</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="using-php-in-the-browser.html">Using PHP in the browser</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="bundling-wordpress-for-the-browser.html">Bundling <wbr/>Word<wbr/>Press for the browser</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="running-wordpress-in-the-browser.html">Running <wbr/>Word<wbr/>Press in the browser</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="service-worker.html">Service workers</a></li>
<li class="pages-entry pages-entry-page pages-entry-depth-2"><a href="wordpress-plugin-ide.html">Word<wbr/>Press plugin IDE</a></li></ul></li>
<li class="tsd-kind-module"><a href="../modules/_php_wasm_progress.html">@php-<wbr/>wasm/progress</a></li>
<li class="tsd-kind-module"><a href="../modules/_php_wasm_web.html">@php-<wbr/>wasm/web</a></li>
<li class="tsd-kind-module"><a href="../modules/_wp_playground_client.html">@wp-<wbr/>playground/client</a></li></ul></li></ul></div></details></nav>
<nav class="tsd-navigation secondary menu-sticky"></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="../assets/main.js"></script></body></html>